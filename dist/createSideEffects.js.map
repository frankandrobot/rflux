{"version":3,"sources":["createSideEffects.js"],"names":[],"mappings":";;;;;kBAiCwB,iB;;AAjCxB;;;;AAEA;;AACA;;;;AAGA,SAAS,0BAAT,CAAoC,OAApC,EAA6C,kBAA7C,EAAiE;;AAE/D,SAAO,UAAC,aAAD,EAAgB,QAAhB;AAAA,WAEL,cACG,MADH,CACU;AAAA,aAAK,EAAE,OAAF,KAAc,OAAnB;AAAA,KADV,EAEG,OAFH,CAEW,kBAAU;;AAEjB,UAAM,UAAU,mBAAmB,OAAO,UAA1B,CAAhB;;AAEA,UAAI,CAAC,OAAL,EAAc;AACZ,cAAM,IAAI,KAAJ,cAAqB,OAArB,uCAA8D,OAAO,UAArE,OAAN;AACD;;AAED,aAAO,QAAQ,OAAO,OAAf,EAAwB,QAAxB,EAAkC,kBAAO,OAAO,kBAAd,CAAlC,CAAP;AACD,KAXH,CAFK;AAAA,GAAP;AAcD;;;;;;;;;;;AAWc,SAAS,iBAAT,CAA2B,OAA3B,QAAkG;AAAA,MAA7D,WAA6D,QAA7D,WAA6D;AAAA,MAAhD,yBAAgD,QAAhD,yBAAgD;AAAA,MAArB,kBAAqB,QAArB,kBAAqB;;;AAE/G,wBAAO,OAAO,OAAP,KAAmB,QAA1B,EAAoC,6CAApC;AACA,wBAAO,WAAP,EAAoB,kBAApB;AACA,wBAAO,kBAAP,EAA2B,yBAA3B;;;AAGA,SAAO,IAAP,CAAY,WAAZ,EAAyB,OAAzB,CAAiC,kBAAU;AACzC,QAAI,yBAAJ,EAA+B;AAC7B,4BAAO,0BAA0B,MAA1B,CAAP,eAAqD,OAArD,iDAAwG,MAAxG;AACD;AACD,0BAAO,mBAAmB,MAAnB,CAAP,eAA8C,OAA9C,yCAAyF,MAAzF;AACD,GALD;;AAOA,8BAA4B,6BAA6B,EAAzD;;AAEA,SAAO,UAAC,aAAD,EAAgB,QAAhB;AAAA,WAA8B;AACnC,YAAM,OAD6B;AAEnC,kBAAY,2BAA2B,OAA3B,EAAoC,kBAApC,EAAwD,aAAxD,EAAuE,QAAvE,CAFuB;AAGnC,mBAAa,sCAAoB,yBAApB,EAA+C,aAA/C;AAHsB,KAA9B;AAAA,GAAP;AAKD","file":"createSideEffects.js","sourcesContent":["import assert from './support/assert'\n\nimport {result} from './Saga'\nimport {bindActionFunctions} from './createStore'\n\n\nfunction _bindSideEffectsObservable(channel, SideEffectHandlers) {\n\n  return (AppDispatcher, AppState) =>\n\n    AppDispatcher\n      .filter(x => x.channel === channel)\n      .flatMap(action => {\n\n        const handler = SideEffectHandlers[action.actionType]\n\n        if (!handler) {\n          throw new Error(`Channel ${channel} does not support side effect \"${action.actionType}\"`)\n        }\n\n        return handler(action.payload, AppState, result(action.__sideEffectCallId))\n      })\n}\n\n/**\n  * SideEffectActionFunctions are optional but if you pass these,\n  * then every SideEffect must have a corresponding action function.\n  *\n  * @param channel\n  * @param SideEffects - map whose keys are the names of the side effects\n  * @param SideEffectActionFunctions - (optional) map of action functions\n  * @param SideEffectHandlers - map of handler functions\n  */\nexport default function createSideEffects(channel, {SideEffects, SideEffectActionFunctions, SideEffectHandlers}) {\n\n  assert(typeof channel === 'string', 'Needs a channel and it needs to be a string')\n  assert(SideEffects, 'Need SideEffects')\n  assert(SideEffectHandlers, 'Need SideEffectHandlers')\n\n  //every side effect must map to an action function and handler\n  Object.keys(SideEffects).forEach(action => {\n    if (SideEffectActionFunctions) {\n      assert(SideEffectActionFunctions[action], `Channel ${channel} is missing side effect action function \"${action}\"`)\n    }\n    assert(SideEffectHandlers[action], `Channel ${channel} is missing side effect handler \"${action}\"`)\n  })\n\n  SideEffectActionFunctions = SideEffectActionFunctions || {}\n\n  return (AppDispatcher, AppState) => ({\n    name: channel,\n    observable: _bindSideEffectsObservable(channel, SideEffectHandlers)(AppDispatcher, AppState),\n    sideEffects: bindActionFunctions(SideEffectActionFunctions)(AppDispatcher)\n  })\n}\n"]}